pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                bat 'docker build -t dotnet .'
                bat "\"C:/Program Files/dotnet/dotnet.exe\" restore \"${workspace}/MVC Project.sln\""
                bat "\"C:/Program Files/dotnet/dotnet.exe\" build \"${workspace}/MVC Project.sln\""
                
            }
        }
        stage('Test') {
            steps {
                bat returnStatus: true, script: "\"C:/Program Files/dotnet/dotnet.exe\" dotnet test \"${workspace}/MVC Project.sln\" "
                }
        }
        stage('Deploy') {
            steps {
                bat returnStatus: true, script: "\"C:/Program Files/dotnet/dotnet.exe\" dotnet test \"${workspace}/MVC Project.sln\" --logger \"trx;LogFileName=unit_tests.xml\" --no-build"
                nunit testResultsPattern: 'Tests\\*Test*\\TestResults\\unit_tests.xml'
}
                
        }
    }
   
}