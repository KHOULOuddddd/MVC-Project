pipeline {
    agent any
    dockerfile {
            filename 'Dockerfile.build'
            dir 'build'
            label 'my-defined-label'
            additionalBuildArgs  '--build-arg version=1.0.2'
            args '-v /tmp:/tmp'
            }  
    stages {
        stage('Build') {
            steps {
                bat "\"C:/Program Files/dotnet/dotnet.exe\" restore \"${workspace}/MVC Project.sln\""
                bat "\"C:/Program Files/dotnet/dotnet.exe\" build \"${workspace}/MVC Project.sln\""
            }
            
        }
        stage('Test') {
            steps {
                bat returnStatus: true, script: "\"C:/Program Files/dotnet/dotnet.exe\" test \"${workspace}/MVC Project.sln\"  --no-build"
                }
            post {
                always {
                    echo "Post-Test res: ${currentBuild.result}"
                    echo "Post-Test currentResult: ${currentBuild.currentResult}"
                }
            }
        }
    
    }
}